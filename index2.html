<html>

<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163808192-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'UA-163808192-1');
	</script>

	<title>Command Lua Docs</title>
	<link rel="stylesheet" type="text/css" href="style.css" / >
	


</head>

<body>
	<div id="header-container">
		<div id="header">
			<div id="header-logo">
				<h1><a href="index2.html"><img src="./assets/images/CommandLuaLogo.svg" height=45px alt="CommandLua"></a>
				</h1>
			</div>
			<div id="header-nav">
				<a class="selected" href="index2.html">Reference</a>
				<!-- <a href="/guides/">Guides</a> -->
				<a href="https://www.matrixgames.com/forums/tt.asp?forumid=1681">Forum</a>
			</div>
		</div>
	</div>
	<div id="container">

		<div id="content">
			<div id="page-title">
				<h2 id="page-title">Command Lua API Documentation, v1328.13</h2>
				<hr>
			</div>
			<div id="nav">
				<ul>
					<li><a href="#News">News</a></li>
					<li><a href="#Introduction">Introduction</a></li>
					<ol>
						<li><a href="#HowToUse">How to Use These Docs</a></li>
						<li><a href="#FirstSteps">First Steps</a></li>
						<li><a href="#ExternalResources">External Resources</a></li>
					</ol>

					<li><a href="#Overview">Overview</a></li>
					<ol>
						<li><a href="#CaseSensitivityandConventions">Case Sensitivity and Conventions</a></li>
                        <li><a href="#EventHandling">Event Handling</a></li>
						<li><a href="#Globals">Global Keywords</a></li>
						<li><a href="#ErrorHandling">Error Handling</a></li>
					</ol>
                    <li><a href="assets/DataTypes.html">Data Types</a></li>
					<li><a href="assets/Functions.html">Functions</a></li>
					<li><a href="assets/Wrappers.html">Wrappers</a></li>
					<!--<li><a href="assets/Selectors.html">Selectors</a></li>-->
					<li><a href="assets/Tables.html">Tables</a></li>
				</ul>
			</div>
            <div id="main">

               <a class="anchor" id="News"></a>
                <h2>News</h2>
                <h4>Command: Modern Operations [in future build]</h4>
               <div class="byline">
			   <p>
					<li>Added Tool_BuildBlankScenario to create a blank scenario</li>
					<li>Added mount magazine to magazine wrapper (see unit magazine table)</li>
					<li>Added to 'No Fire Zone' to zone wrapper (for non-nav)</li>
	                <li>Added FocusOnStrike property to strike mission wrapper</li>
                </p>
				</div>
 				<p>
					
				</p>
               <h4>Command: Modern Operations 1.06 v1328.13</h4>
               <div class="byline">
			   <p>
					<ul>
	                <li>Added target property to unit wrapper</li>
	                <li>Added TimeOnTargetStaion, TakeOffTime properties to mission wrapper</li>
					<li>Added markedAsDecoy to contact wrapper</li>
					</ul>
                </p>
               <h4>Command: Modern Operations 1.06 v1328.11</h4>
               <div class="byline">
			   <p>
					<ul>
	                <li>Added UI_CallAdvancedHTMLDialog()</li>
					</ul>
                </p>
				</div>
 				<p>
					
				</p>

               <h4>Command: Modern Operations 1.06 v1328.10/CPE 2.2.5</h4>
               <div class="byline">
				<p>
					<ul>
					<li>Added method :GetSensor() to Unit wrapper <span class="pro_only">PRO ONLY </span> </li>
					<li>Added Tool_SatelliteCoveragePrediction() <span class="pro_only">PRO ONLY </span> </li>
					</ul>
				</p>

               <h4>Command: Modern Operations 1.06 v1328.9</h4>
               <div class="byline">
				<p>
					<ul>
					<li>Added cargo types to ScenEdit_UpdateUnitCargo() </li>
					<li>Added add/remove fuel source to ScenEdit_UpdateUnit() </li>
					</ul>
				</p>

               <h4>Command: Modern Operations v1334</h4>
               <div class="byline">
				<p>
					<ul>
					<li>Added a 'slant' distance option to Tool_Range() </li>
					</ul>
				</p>

               <h4>Command: Modern Operations v1317</h4>
               <div class="byline">
				<p>
					<ul>
					<li>Added ScenEdit_GetKeyStore() to dump out key store as Lua table</li>				
					<li>Added .groupLead to Unit wrapper</li>
					<li>Updated ScenEdit_HostUnitToParent() </li>
					<li>Added UseCustomIntermittentEmissionOnly to wrapper Unit</li>
					</ul>
				</p>

                <h4>Command: Modern Operations v1309/1307.1</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Add EMCON to ScenEdit_GetDoctrine() list</li>				
					<li>Tweaked ScenEdit_AttackContact() to handle course for mode 1 attacks</li>				
					<li>Tweaked ScenEdit_AttackContact() to use first availsble mount if none specified</li>				
					</ul>
					
				</p>
                <h4>Command: Modern Operations v1308</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Add .IsLoadedAsCargo to unit wrapper</li>				
					</ul>
					
				</p>
				<h4>Command: Modern Operations v1298</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Add .SAR_enabled to unit wrapper</li>
					<li>Add .beingPickedUp to unit wrapper</li>
					<li>Add .pickUpTarget to unit wrapper</li>
					<li>Add .pickedUpBy to unit wrapper</li>
					</ul>
				</p>

				<h4>Command: Modern Operations v1290</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Add .IsDestroyed to unit wrapper</li>
					</ul>
				</p>

				<h4>Command: Modern Operations v1288</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Add .noiseLevel and .signature to unit wrapper</li>
					</ul>
				</p>

				<h4>Command: Modern Operations v1287</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li><span class="pro_only">PRO ONLY </span>ScenEdit_GetSensorData() - recall some sensor data</li>
					</ul>
				</p>
				<h4>Command: Modern Operations v1283</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Tool_LOS() - permit location points to be used as observer or target</li>
					</ul>
				</p>
				<h4>Command: Modern Operations v1280</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Added Tool_LOS_Points() - checks the status of the LOS between 2 points</li>
					</ul>
				</p>

				<h4>Command: Modern Operations v1278</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
					<li>Added ESM horizon to function Tool_LOS()</li>
					</ul>
				</p>

                <h4>Command: Modern Operations v1268</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
						<li>Added function Tool_LOS() for radar/LOS checks</li>
						<li>Added DATEFORMAT to ScenEdit_SetStartTime() for consistency</li>
						<li>Updated Cargo functions - the base Lua cargo wrapper was added in 1268 </li>
							<ul>
								<li>LuaWrapper_ActiveUnit</li>
								<li>LuaWrapper_Cargo</li>
							</ul>
					</ul>
				</p>

                <h4>Command: Modern Operations v1266</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
						<li>Added function Tool_LOS() for radar/LOS checks</li>
						<li>Added DATEFORMAT to ScenEdit_SetStartTime() for consistency</li>
					</ul>
				</p>
				
                <h4>Command: Modern Operations v1265</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
						<li>Added function ScenEdit_SplitUnit() and ScenEdit_MergeUnits of Facility units</li>
						<li>Added function ScenEdit_TransferMount() for buildup/breakdown of Facility units</li>
						<li>Allow setting of a custome formation in ScenEdit_SetUnit()</li>
						<li>Add color to Add/SetReferencePoint and Add/SetZone</li>
						<li>Add endurance to unit wrapper</li>
					</ul>
				</p>
                <h4>Command: Modern Operations v1260</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
						<li>Adjusted ScenEdit_SetTime() to be aware of Public/Pro default formats</li>
					</ul>
				</p>
                <h4>Command: Modern Operations v1243.3 {codename 'Tiny')</h4>
               <div class="byline">
                </div>
				<p>
				This release aligns the Public and Professional version Lua procedures.<br />
				Also the format of the pages has been updated to better align the information and allow more details to be made available.
				</p>
                <h4>Command: Modern Operations v1147.37</h4>
               <div class="byline">
                </div>
				<p>
					<ul>
						<li>Added function ScenEdit_GetMissions()</li>
						<li>Updated method on "Scenario" wrapper: Title can be updated now</li>
						<li>Corrected function ScenEdit_SetStartTime()</li>
						<li>New method on "Unit" wrapper - :getwaypoint() </li>
						<li>New wrapper 'waypoints' used by :getwaypoint() </li>
					</ul>
				</p>
                <h4>Command: Modern Operations v1147.34</h4>
                <div class="byline">
                </div>
				<p>
                    <ul> 
                        <li>New method on "Loadout" wrapper: setExactWeaponQuantity(string wpn_guid, integer quantity) sets weapon current quantity and returns the resulting quantity.</li>
                        <li>New method on "Unit" wrapper: getUnitMagazine(string magazineguid) returns the specified magazine, if magazine exists on unit<br>		getUnitMountMagazine(string mountguid) returns the magazine for the specified mount, if mount exists on unit</li>
						<li>Updated method on "Unit" wrapper: filterOnComponent() optional DBID to apply in addition to 'type'</li>
                    </ul>
				</p>
               <h4>Command: Modern Operations v1147.33</h4>
                <div class="byline">
                </div>
				<p>
                    <ul>
                        <li>New property on "Unit" wrapper: jammed, jammer, pitch, groundSpeed</li>
                        <li>New property on "Unit" wrapper: airbornetime_v, readytime_v, crew</li>
                        <li>New property on "Contact" wrapper: lastDetections</li>
                        <li>New method on "Scenario" wrapper: ResetLossExp, ResetScore</li>
                    </ul>
				</p>
               <h4>Command: Modern Operations v1147.30</h4>
                <div class="byline">
                </div>
				<p>
                    <ul>
                        <li>New property on "Unit" wrapper: isEscort</li>
                    </ul>
				</p>
                <h4>Command: Modern Operations v1147.26</h4>
                <div class="byline">
                    <p>
                        <sub>30th June 2021</sub>
                    </p>
                </div>
				<p>
                    <ul>
                        <li>New property on "Unit" wrapper: avoidCavitation, readytime, unassign, oldDamagePercent</li>
                        <li>New property on "SetUnit" function: AvoidCavitation, TimeToReady_Minutes, Unassign</li>
                    </ul>
				</p>
                <h4>Command: Modern Operations v1147.10</h4>
                <div class="byline">
                    <p>
                        <sub>11th June 2020</sub>
                    </p>
                </div>
                <p>
                    Build 1147.10 brings new tools to work with sides and their missions:
                    <ul>
                        <li>New function: VP_GetSides()</li>
                        <li>New method on "Side" wrapper: unitsInArea()</li>
                        <li>New property on "Side" wrapper: missions</li>
                    </ul>
                </p>
                <h4>Command: Modern Operations v1143.1</h4>
                <div class="byline">
                    <p>
                        <sub>21st April 2020</sub>
                    </p>
                </div>
                <p>
                    Build 1143.1 provides new features to manage aircraft and their munitions at airbases:
                    <ul>
                        <li>New function: ScenEdit_DistributeWeaponAtAirbase()</li>
                        <li>New function: ScenEdit_ClearAllAircraft()</li>
                        <li>New function: ScenEdit_ClearAllMagazines()</li>
                    </ul>
                </p>

                <h4>Command Lua Docs gets a makeover!</h4>
                <div class="byline">
                    <p>
                        <sub>April 17th 2020</sub>
                    </p>
                </div>
                <p>
                    <strong>
                        After 5 years using the <a href="https://stevedonovan.github.io/ldoc/">LDoc format</a>, the
                        Command Lua API Documentation struts into the 2020's with a sleek new interface, inspired by
                        industry leaders in web documentation.
                    </strong> The new look is accompanied by an extensive
                    re-write and reorganisation of existing content, consolidation of content from various sources, and
                    brand new content to assist Lua newbies and pros alike in their Command Lua adventures.
                </p>
                <p>
                    The old site can be found <a href="./oldsite/index.html">here</a> for metathesiophobics, however it
                    won't be updated.
                </p>
				
<!--                 
				<p>
                    The following new functions are available in this release:
                    <ul class="ul-2-columns">
                    </ul>
                </p>

                <p>
                    Check them out in the <a href="#Functions">Functions</a> section or by clicking the links above.
                </p>

                <a class="anchor" id="Future Enhancements"></a>
                <h2>Future Enhancements</h2>
                <p>
                    Additions:
                <p>
                <ul>
                </ul>
                </p>
                <p>
                   Changes:
                <ul>
                </ul>
                </p> -->
				
                <a class="anchor" id="Introduction"></a>
                <h2>Introduction</h2>
                <p>
                    Welcome to the documentation for the Command Lua Application Programming Interface (API). The
                    Command Lua API allows users to control behaviour of Command directly by using the Lua scripting
                    language, providing a flexible and easy to use tool for users to extend or customize the built-in
                    functionality of Command.
                </p>

                <h3>What Can I Do With the Command Lua API?</h3>
                <p>
                    Since the Command Lua API interfaces directly with the source code of Command, users are provided
                    with the ability to implement virtually any desired behaviour. Some common uses include:
                </p>
                <ul>
                    <li>Precise placement and orientation of units using the console</li>
                    <li>Customised message pop-ups</li>
                    <li>Randomising gameplay elements such as weather, unit types, positions etc</li>
                    <li>Extending existing AI behaviour</li>
                    <li>'Spawning' of units in conjunction with the event editor</li>
                    <li>Implementation of additional features, such as:</li>
                    <ul>
                        <li>Downed pilots</li>
                        <li>Combat search and rescue</li>
                        <li>'Purchasing' additional units</li>
                        <li>Extended communications modelling</li>
                    </ul>
                </ul>

                <p>
                    While the above items are common uses for the Command Lua API, the integration with source code
                    allows users to custom-design virtually any feature or modification that they desire.
                </p>

                <a class="anchor" id="top"></a>

                <h3><a class="anchor" id="HowToUse"></a>How to Use These Docs</h3>
                <p>
                    Not everyone is a programmer--and even experienced programmers are daunted by dry, wall-of-text
                    documentation. With this in mind, we have taken steps to make the documentation for the Command Lua
                    API accessible to users of all levels of skill, while retaining the depth and detail of technical
                    documentation. To achieve this:
                </p>
                <ul>
                    <li>
                        Examples are offered where practical
                    </li>
                    <li>
                        Color coding and linking are used extensively, and
                    </li>
                    <li>
                        Simple language is used to explain concepts wherever possible
                    </li>
                </ul>

                <h5>Need Help?</h5>
                <p>
                    Even the best written documentation is no match for a discussion with an expert. We have a lively
                    community of users of all levels--from casual Lua neophytes to professional users who work with the
                    Command Lua API as their primary job--and the place to get in touch with them is the <a href="https://www.matrixgames.com/forums/tt.asp?forumid=1681">Lua Legion</a> subforum on the <a href="https://www.matrixgames.com/forums/tt.asp?forumid=1154">Official Command Forums</a>. The
                    forum is actively monitored by WarfareSims staff, and most questions are answered within 24 hours.
                </p>

                <h5>Found Something Wrong?</h5>
                <p>
                    We're human too; there are bound to be mistakes or inaccuracies in documentation for live, complex,
                    evolving software. If you find something that is incorrect or unclear, please let us know by
                    <!-- using
        the <a href="#ReportAProblem">report a problem</a> form or  -->
                    dropping us a message on the <a href="">Official Discord</a>, <a href="https://twitter.com/warfaresims">Twitter</a> or <a href="https://www.facebook.com/WarfareSims/">FaceBook</a>. Better yet, <a href="https://www.matrixgames.com/forums/tt.asp?forumid=1154">come join the community</a>!
                </p>
                <h4>Conventions</h4>
                <p>
                    The following conventions are used throughout this documentation to allow at-a-glance visualisation
                    of data types, code snippets and example code.
                </p>
                <ul class="ul-no-bullets">
                    <li>
                        <code>Code within text</code> is differentiated from normal text with a border, additional
                        spacing and a console-like font.
                    </li>
                    <li>
                        <span class="parameter"><a href="">Parameter</a></span> references appear similar to in-text
                        code with a light blue background. The text links to the relevant documentation (although not in
                        this example, as a parameter can be any of the types below).
                    </li>
                    <li>
                        <p>
                            <span class="selector"><a href="assets/Selectors.html">Selector</a></span> references appear similar to
                            in-text code with a light green background. The text links to the relevant <a href="#Selectors">Selector</a> documentation.<br />
                            <strong>Note:</strong> This has been mainly replaced by expanding a Selector in a function parameter to the actual parameters used by that function.
                        </p>
                    </li>
                    <li>
                        <span class="wrapper"><a href="assets/Wrappers.html">Wrapper</a></span> references appear similar to
                        in-text code with a light purple background. The text links to the relevant <a href="#Wrappers">Wrapper</a> documentation.
                    </li>
                    <li>
                        <span class="table"><a href="assets/Tables.html">Table</a></span> references appear similar to in-text code
                        with a light orange background. The text links to the relevant <a href="#Tables">Table</a>
                        documentation.
                    </li>
                    <li>
                        <p>
                            <span class="table"> {} </span> indicates items in a following list are elements in a Lua table.<br />
                            <span class="table"> {} of multiple </span> indicates the Lua table can occur multiple times.<br />
                            <strong>Note:</strong> If there is no 'named' value, then the Lua table would need to be accessed by the [] table convention.
                        </p>
                    </li>

                    <li>
                        <p>
                            <span class="types"><a href="assets/DataTypes.html">Data type</a></span> descriptions appear similar to
                            in-text code with bold font a dark grey background. <br />
                            If the Data Type is not one of the standard Lua data types, the text is white and<br />
                            &nbsp;&nbsp;&nbsp;&nbsp;a) links to the relevant <a href="#DataTypes">Data Type</a> documentation or<br />
                            &nbsp;&nbsp;&nbsp;&nbsp;b) shows a hover box containing the valid values.<br />
                            Otherwise, the text is color coded to match the appearance of the standard datatype:
                            <ul>
                                <li><span class="types"><span class="string">string</span></span></li>
                                <li><span class="types"><span class="boolean">boolean</span></span></li>
                                <li><span class="types"><span class="number">number</span></span></li>
                            </ul>
                        </p>
                    </li>
                    <li>
                        <span class="readonly">READ ONLY</span> properties are denoted by a tag with the words READ ONLY
                        in all caps, on a yellow background.
                    </li>
                    <li>
                        <span class="pro_only">PRO ONLY</span> functionality is denoted by a tag with the words PRO ONLY
                        in all caps, on a lavender background.
                    </li>
                    <li>
                        <details>
                            <summary>
                                Sections with long enumerations or data pools have a drop-down carat to show the
                                relevant data. This reduces visual clutter when looking at other items while allowing
                                quick access to data without leaving the page.
                            </summary>
                            <ul>
                                <li>Here</li>
                                <li>is</li>
                                <li>an</li>
                                <li>example</li>
                                <li>of</li>
                                <li>visual</li>
                                <li>clutter</li>
                                <li>that</li>
                                <li>is</li>
                                <li>hidden</li>
                                <li>with</li>
                                <li>this</li>
                                <li>convention</li>
                            </ul>
                        </details>
                    </li>
                </ul>
				<br/>
				<!--
                <div class="example">
                    <code>
                        <span class="comment">--Example code is written as it appears in the Command Lua console, with additional spacing and indentation for clarity</span>
                        <br>
                        <br>
                        <span class="comment">
                            --[[
                            <br>
                            Native Lua functions, comparators and boolean values are blue
                            <br>
                            Operators (+,-,/,*) and constructors ( (,),{,} ) are purple
                            <br>
                            Strings are red
                            <br>
                            Numbers are gold
                            <br>
                            Variables and function names are black
                            <br>
                            ]]
                        </span>
                        <br>
                        <br>
                        <span class="local">local</span>
                        mission
                        <span class="operator">=</span>
                        ScenEdit_AddMission
                        <span class="operator">(</span>
                        <span class="string">'USA'</span>,
                        <span class="string">'Marker strike'</span>,
                        <span class="string">'strike'</span>,
                        <span class="operator">{</span>
                        type
                        <span class="operator">=</span>
                        <span class="string">'land'</span>
                        <span class="operator">}</span>
                        <span class="operator">)</span>
                        <br>
                        <span class="comparator">if</span> mission
                        <span class="operator">==</span>
                        <span class="nil" />
                        <span class="comparator">then</span>
                        <br>
                        <span class="tab1">
                            <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;if</span>
                            _errnum_
                            <span class="operator">~=</span>
                            <span class="number">0</span>
                            <span class="comparator">then</span>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="print" />
                            <span class="operator">(</span>
                            <span class="string">'Failed to add:'</span>
                            .. _errmsg_
                            <span class="operator">)</span>
                            <br>
                            <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;else</span>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="print" />
                            <span class="operator">(</span>
                            <span class="string">'Something else'</span>
                            <span class="operator">)</span>
                            <br>
                            <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;end</span>
                            <br>
                            <span class="comparator">else</span>
                            <br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="print"></span>
                            <span class="operator">(</span>
                            <span class="string">
                                mission</span?
                                <span class="operator">)</span>
                                <br>
                                <span class="comparator">end</span>
                            </span>
                    </code>
                </div>
				-->
                <div class="note-alert">
                    <p>
                        <strong>Note:</strong> Information that is particularly useful or worthy of special mention
                        appears in centered boxes with a blue background.
                    </p>
                </div>

                <div class="note-caution">
                    <p>
                        <strong>Caution:</strong> Advice on common pitfalls appears in centered boxes with a yellow
                        background.
                    </p>
                </div>

                <div class="note-warning">
                    <p>
                        <strong>Warning:</strong> Information that could prevent you from losing work or otherwise
                        disrupting your workflow appears in centered boxes with a red background. <strong>
                            If you see one
                            of these, pay attention!
                        </strong>
                    </p>
                </div>
                </p>
                <h3><a class="anchor" id="FirstSteps"></a>First Steps</h3>
                <p>
                    If you're already familiar with writing scripts in Lua, dive right in and take a look at the <a href="#Functions">Functions</a> section. This is the meat of the Command Lua API--the direct
                    interface with the source code that makes things happen.
                </p>

                <p>
                    If you're somewhat familiar with programming in general--but not Lua in particular--take a look at
                    the <a href="#ExternalResources">External Resources</a> for a primer on Lua as a language, then head
                    on over to the <a href="#Functions">Functions</a> section to get to grips with the tools at your
                    disposal.
                </p>

                <!-- <p>
        If you've never written a line of code in your life, <strong>don't panic--we've got you</strong>. We
        have a comprehensive set of <a href="#Guides">Guides</a> to get you started. Once you've conquered
        the <a href="#Guides">Guides</a> section, you'll be ready to jump in the deep end and start using
        the <a href="#Functions">Functions</a> to bend Command to your will!
    </p> -->

                <a class="anchor" id="ExternalResources"></a>
                <h3>External Resources</h3>
                <p>The links below contain useful resources for getting started with Lua in general:</p>
                <ul>
                    <li>
                        <a href="http://lua-users.org/wiki/TutorialDirectory">Tutorials from the Lua Users Wiki</a> -
                        The first four tutorials (<a href="http://lua-users.org/wiki/LuaTypesTutorial">Types</a>, <a href="http://lua-users.org/wiki/AssignmentTutorial">Assignment</a>, <a href="http://lua-users.org/wiki/NumbersTutorial">Numbers</a> and <a href="http://lua-users.org/wiki/StringsTutorial">Strings</a>) as well as the <a href="http://lua-users.org/wiki/TablesTutorial">Tables</a> and <a href="http://lua-users.org/wiki/FunctionsTutorial">Functions</a> tutorials are recommended
                        reading.
                    </li>
                    <li><a href="https://en.wikibooks.org/wiki/Lua_Programming">The Lua Programming WikiBook</a></li>
                    <li><a href="https://www.lua.org/manual/5.3/">Lua 5.3 Reference Manual</a></li>
                </ul>
                <div class="note-alert">
                    <p>
                        <strong>Note:</strong> These references are external to WarfareSims and are subject to change.
                    </p>
                </div>

                <a class="anchor" id="Overview"></a>
                <h2>Overview</h2>

                <a class="anchor" id="CaseSensitivityandConventions"></a>
                <h3>Case Sensitivity and Conventions</h3>
                <p>
                    Lua is a case sensitve language. When accessing object properties directly as in
                    <code>unit.name</code>, the property should be in lowercase which will match the Lua generated code.
                </p>

                <p>
                    However, when accessing the properties through the module functions, both the keyword/property and
                    the value are case insensitive; the code will worry about matching them up.
                </p>

                <div class="note-alert">
                    <p>
                        <strong>Note:</strong> There are some special cases where uppercase letters are used to name
                        fields (e.g. <code>mission.SISH=true</code> which is a shortcut for
                        <code>scrub_if_side_human</code>). These are documented in the relevant wrapper, selector or
                        table documentation.
                    </p>
                </div>

                <!-- <h5>Example 1</h5>
    <p>
        In the code below, note that incorrect case returns an undesired value while using the correct case
        returns the desired value.
    </p>

    <div class="example">
        <p>
            <code>
                    <span class="local">local</span>
                    mission
                    <span class="operator">=</span>
                    ScenEdit_AddMission
                    <span class="operator">(</span>
                    <span class="string">'USA'</span>,
                    <span class="string">'Marker strike'</span>,
                    <span class="string">'strike'</span>,
                    <span class="operator">{</span>
                    type
                    <span class="operator">=</span>
                    <span class="string">'land'</span>
                    <span class="operator">}</span>
                    <span class="operator">)</span>
                    <br>
                    <span class="comparator">if</span> mission
                    <span class="operator">==</span>
                    <span class="nil"/>
                    <span class="comparator">then</span>
                    <br>
                    <span class="tab1">
                        <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;if</span>
                        _errnum_
                        <span class="operator">~=</span>
                        <span class="number">0</span>
                        <span class="comparator">then</span>
                        <br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="print"/>
                        <span class="operator">(</span>
                        <span class="string">'Failed to add:'</span>
                        .. _errmsg_
                        <span class="operator">)</span>
                        <br>
                        <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;else</span>
                        <br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="print"/>
                        <span class="operator">(</span>
                        <span class="string">'Something else'</span>
                        <span class="operator">)</span>
                        <br>
                        <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;end</span>
                        <br>
                        <span class="comparator">else</span>
                        <br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="print"></span>
                        <span class="operator">(</span>
                        <span class="string">mission</span?
                        <span class="operator">)</span>
                        <br>
                        <span class="comparator">end</span>
                    </span>
                </code>
        </p>
    </div> -->
                    <hr>
                    <a class="anchor" id="EventHandling"></a>
                    <h3>Event Handling</h3>
                    <p>
                        An event consists of one or more triggers, an optional set of conditions, and one or actions to perform when the trigger(s) and condition(s) are fulfilled. With Lua, you can create triggers, conditions and actions independently of the editor, and create or modify events with them.
                    </p>

                    <p>
                        There are separate functions to handle the creation, update and deletion of the components of an event.
                    </p>
                    <h4>ScenEdit_SetTrigger( { table } )</h4>
                    <p>
                        As it sounds, a trigger is something that fires off, and results in a success or fail. Apart from a few common keywords, each trigger has a set of keywords.
                    </p>
                    <p>
                        The common keywords used in the Lua table are:
                    </p>
                    <ul class="ul-no-bullets">
                        <li><strong>Description</strong> The name given to the trigger. The keyword 'name' can also be used for this.</li>
                        <li><strong>Mode</strong> The type of operation to perform. Operations are 'list', 'add', 'remove', and 'update'.</li>
                        <li><strong>ID</strong> The GUID used to reference the trigger. This is used internally and is only for reference.</li>
                    </ul>
                    <p>
                        The trigger related keywords are listed below.
                    </p>
                    <table class="table_borders">
                        <tr>
                            <th>Trigger type</th>
                            <th>Keyword</th>
                            <th>Comment</th>
                        </tr>
                        <tr>
                            <td>Points</td>
                            <td>SideID</td>
                            <td>Side to adjust points for</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>PointValue</td>
                            <td>Current points</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>ReachDirection</td>
                            <td>GoOver = 0, MatchExactly = 1, GoUnder = 2</td>
                        </tr>
                        <tr>
                            <td>RandomTime</td>
                            <td>EarliestTime</td>
                            <td>Earliest date/time to start checks</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>LatestTime</td>
                            <td>Latest date/time to stop checks</td>
                        </tr>
                        <tr>
                            <td>RegularTime</td>
                            <td>Interval</td>
                            <td>Time interval (1 sec, 2sec, 5sec, etc)</td>
                        </tr>
                        <tr>
                            <td>ScenEnded</td>
                            <td></td>
                            <td>No additional keywords</td>
                        </tr>
                        <tr>
                            <td>ScenLoaded</td>
                            <td></td>
                            <td>No additional keywords</td>
                        </tr>
                        <tr>
                            <td>Time</td>
                            <td>Time</td>
                            <td>Actual date/time to fire on</td>
                        </tr>
                        <tr>
                            <td>UnitDamaged</td>
                            <td>DamagePercent</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetFilter</td>
                            <td>See below</td>
                        </tr>
                        <tr>
                            <td>UnitDestroyed</td>
                            <td>TargetFilter</td>
                            <td>See below</td>
                        </tr>
                        <tr>
                            <td>UnitDetected</td>
                            <td>TargetFilter</td>
                            <td>See below</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>DetectorSideID</td>
                            <td>Side doing the detecting</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>MCL</td>
                            <td>Minimum classification level</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Area</td>
                            <td>Table of reference points</td>
                        </tr>
                        <tr>
                            <td>UnitEmissions</td>
                            <td>TargetFilter</td>
                            <td>See below</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>DetectorSideID</td>
                            <td>Side doing the detecting</td>
                        </tr>
                        <tr>
                            <td>UnitEntersArea</td>
                            <td>TargetFilter</td>
                            <td>See below</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Area</td>
                            <td>Table of reference points</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>ETOA</td>
                            <td>Earliest date/time of arrival</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>LTOA</td>
                            <td>Latest date/time of arrival</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>NOT</td>
                            <td>Not in the area</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>ExitArea</td>
                            <td>Leaving area</td>
                        </tr>
                        <tr>
                            <td>UnitRemainsInArea</td>
                            <td>TargetFilter</td>
                            <td>See below</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Area</td>
                            <td>Table of reference points</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TD</td>
                            <td>Time to remain in area in seconds (or as days:hours:minutes:seconds)</td>
                        </tr>
                        <tr>
                            <td>UnitBaseStatus</td>
                            <td>TargetFilter</td>
                            <td>See below </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetBase</td>
                            <td>[Optional] The base name/guid to monitor a/c or ships on, or all bases if not present </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetCondition</td>
                            <td>Status number to monitor </td>
                        </tr>
                        <tr>
                            <td>UnitCargoMoved</td>
                            <td>CargoFilter</td>
                            <td>See below </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetLimitReceived</td>
                            <td>Number received to trigger </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetLimitSent</td>
                            <td>Number sent to trigger </td>
                        </tr>
                    </table>

                    <a class="anchor" id="hook_TargetFilter"></a>
					<h5>TargetFilter</h5>
                    <p>A series of filters to apply to units. Only units matching this filter will fire the trigger.</p>
                    <table class="table_borders">
                        
                        <tr>
                            <th>TargetFilter</th>
                            <th>Keyword</th>
                            <th>Comment</th>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetSide</td>
                            <td>Side to fillter on</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetType</td>
                            <td>Type of unit (ship, submarine, etc)</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetSubType</td>
                            <td>Subtype of the above unit type</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>SpecificUnitClass</td>
                            <td>Unit class (DBID)</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>SpecificUnitID</td>
                            <td>Actual unit</td>
                        </tr>
                    </table>
                    <p>Note that side is mandatory, but you can specify a unit or type/sub/class. However, if using type/sub/class, you can use</p>
                        <ul class="ul-no-bullets">
                            <li>type, or</li>
                            <li>type and subtype, or </li>
                            <li>type, subtype (optional as it is inferred from class) and class. </li>
                        </ul>
                    
                    <h5>TargetType</h5>
                    <p></p>
                    <table class="table_borders">
                        <tr>
                            <th></th>
                            <th></th>
                        </tr>
                        <tr>
                            <td>Aircraft</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>Ship</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>Submarine</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td>Facility</td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>Aimpoint</td>
                            <td>5</td>
                        </tr>
                        <tr>
                            <td>Weapon</td>
                            <td>6</td>
                        </tr>
                        <tr>
                            <td>Satellite </td>
                            <td>7</td>
                        </tr>
                    </table>

                    <h5>CargoFilter</h5> 
                    <p>A series of filters to apply to cargo items, similar to the TargetFilter.</p>
                    <table class="table_borders">
                        
                         <tr>
                            <th>CargoFilter</th>
                            <th>Keyword</th>
                            <th>Comment</th>
                        </tr>
                       <tr>
                            <td></td>
                            <td>TargetType</td>
                            <td>Type of cargo item (personel[1000],etc)</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>SpecificUnitClass</td>
                            <td>Cargo class (DBID)</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>SpecificUnitID</td>
                            <td>Actual cargo item</td>
                        </tr>
                    </table>
                    
                    <h5>TargetType</h5>
                    <p></p>
                    <table class="table_borders">
                        <tr>
                            <th></th>
                            <th></th>
                        </tr>
                        <tr>
                            <td>Aircraft</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>Ship</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>Submarine</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td>Facility</td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>Aimpoint</td>
                            <td>5</td>
                        </tr>
                        <tr>
                            <td>Weapon</td>
                            <td>6</td>
                        </tr>
                        <tr>
                            <td>Satellite </td>
                            <td>7</td>
                        </tr>
                    </table>

                    <h5>Examples</h5>
                    <p>Create a trigger for a specific unit leaving an area</p>
                    <div class="example"><code>local a = ScenEdit_SetTrigger({mode=<span class="string">'add'</span>,<br>
                        type=<span class="string">'UnitEntersArea'</span>,<br>
                        name=<span class="string">'Sagami exiting hot zone'</span>,<br>
                        targetfilter={SPECIFICUNIT=<span class="string">'AOE 421 Sagami'</span>},<br>
                        area={<span class="string">'rp-1126'</span>,<span class="string">'rp-1127'</span>,<span class="string">'rp-1128'</span>,<span class="string">'rp-1129'</span>},<br>
                        exitarea=<span class="boolean">true</span>})</code>
                    </div>
                    <div class="note-alert">
                        <p>
                            <strong>Note:</strong> The variable <code>a</code> will contain the trigger information. It will be <code>nil</code> if the trigger failed in a non-interactive script as in an event.
                        </p>
                    </div>
                    <p>Rename the trigger to <i>'any type of AOE entering hot zone'</i></p>
                    <div class="example">
                        <code>local a = ScenEdit_SetTrigger({mode=<span class="string">'update'</span>,<br>type=<span class="string">'UnitEntersArea'</span>,<br>name=<span class="string">'Sagami exiting hot zone'</span>,<br>rename=<span class="string">'Any AOE entering hot zone'</span>,<br>targetfilter={TargetSubType = <span class="string">'5023'</span>,TargetType = <span class="string">'2'</span>,TargetSide=<span class="string">'sidea'</span>},<br>area={<span class="string">'rp-1126'</span>,<span class="string">'rp-1127'</span>,<span class="string">'rp-1128'</span>,<span class="string">'rp-1129'</span>},<br>exitarea=<span class="boolean">false</span>})</code>
                    </div>
                    
                    <p>Remove the trigger named <i>'any type of AOE entering hot zone'</i></p>
                    <div class="example">
                        <code>local a = ScenEdit_SetTrigger({mode=<span class="string">'remove'</span>,type=<span class="string">'UnitEntersArea'</span>,name=<span class="string">'Any AOE entering hot zone'</span>})</code>
                    </div>
                    <div class="note-alert">
                        <p>
                            <strong>Note:</strong> If the trigger is assigned to an event, it can't be removed until removed from the event.
                        </p>
                    </div>
                    <hr>
                    <h4>ScenEdit_SetCondition( { table } )</h4>
                    <p>
                        As it sounds, a condition is something that can be further applied once the trigger has fired, and results in a success or fail. Apart from a few common keywords, each condition has a set of keywords.
                    </p>
                    <p>
                        The common keywords used in the Lua table are:
                        <ul class="ul-no-bullets">
                            <li><strong>Description:</strong> the name given to the condition. The keyword 'name' can also be used for this.</li>
                            <li><strong>Mode:</strong> type of operation to perform. Operations are 'list', 'add', 'remove', and 'update'.</li>
                            <li><strong>ID:</strong> the GUID used to reference the condition. This is used internally and is only for reference.</li>
                        </ul>
                    </p>
                    <p>
                        The condition related keywords are listed below.
                    </p>
                    <table class="table_borders">
                        <tr>
                            <th>Condition type</th>
                            <th>Keyword</th>
                            <th>Comment</th>
                        </tr>
                        <tr>
                            <td>LuaScript</td>
                            <td>ScriptText</td>
                            <td>A Lua script</td>
                        </tr>
                        <tr>
                            <td>ScenHasStarted</td>
                            <td>NOT</td>
                            <td>A NOT modifier for scenario NOT started yet</td>
                        </tr>
                        <tr>
                            <td>SidePosture</td>
                            <td>ObserverSideID</td>
                            <td>Side that views TargetSide as ...</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetSideID</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>TargetPosture</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>NOT</td>
                            <td>A NOT modifier to change condition from true to false</td>
                        </tr>
                    </table>
                    <div class="note-caution"> 
                        <p>
                            <strong>Caution:</strong> For scripts, use <code>'\r\n'</code> to represent new lines, otherwise a multi-line script may not run.
                        </p>
                    </div>

                    <div class="example"><code>ScriptTest=<span class="string">'--comment\r\nif unit ~= nil then\r\n return true\r\n else\r\n return false\r\n end'</span></code></div>
                    
                
                        <h5>Examples</h5>

                    <p>Create a condition for sideA being hostile to sideB</p>
                    <div class="example">
                        <code>
                            local a = ScenEdit_SetCondition({mode=<span class="string">'add'</span>,<br>
                                type=<span class="string">'SidePosture'</span>,<br>
                                name=<span class="string">'sideA hostile to sideB'</span>,<br>
                                ObserverSideId=<span class="string">'sidea'</span>,<br>
                                TargetSideId=<span class="string">'sideb'</span>,<br>
                                targetposture=<span class="string">'hostile'</span>})
                        </code>
                    </div>
                    <div class="note-alert">
                        <p>
                            <strong>Note:</strong> The variable <code>a</code> will contain the trigger information. It will be <code>nil</code> if the trigger failed in a non-interactive script as in an event.
                        </p>
                    </div>
                    <hr>
                    <h4>ScenEdit_SetAction( { table } )</h4>
                    <p>
                        As it sounds, a action is something that will be done once the trigger (and condition) are successful. Apart from a few common keywords, each action has a set of keywords.
                    </p>
                    <p>
                        The common keywords used in the Lua table are:
                        <ul class="ul-no-bullets">
                            <li><strong>Description:</strong> the name given to the condition. The keyword 'name' can also be used for this.</li>
                            <li><strong>Mode:</strong> type of operation to perform. Operations are 'list', 'add', 'remove', and 'update'.</li>
                            <li><strong>ID:</strong> the GUID used to reference the condition. This is used internally and is only for reference.</li>
                        </ul>
                    </p>
                    <p>The action related keywords are listed below.<br>
                    <table class="table_borders">
                        <tr>
                            <th>Action type</th>
                            <th>Keyword</th>
                            <th>Comment</th>
                        </tr>
                        <tr>
                            <td>ChangeMissionStatus</td>
                            <td>MissionID</td>
                            <td>Mission identifier</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>NewStatus</td>
                            <td>New status - active(0) or inactive (1)</td>
                        </tr>
                        <tr>
                            <td>EndScenario</td>
                            <td></td>
                            <td>No additional keywords</td>
                        </tr>
                        <tr>
                            <td>LuaScript</td>
                            <td>ScriptText</td>
                            <td>A Lua script</td>
                        </tr>
                        <tr>
                            <td>Message</td>
                            <td>SideID</td>
                            <td>Side to see message</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Text</td>
                            <td>Message text to show</td>
                        </tr>
                        <tr>
                            <td>Points</td>
                            <td>PointChange</td>
                            <td>Value to change points by (+/-)</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>SideID</td>
                            <td>Side affected</td>
                        </tr>
                        <tr>
                            <td>TeleportInArea</td>
                            <td>UnitIDs</td>
                            <td>Table of unit GUIDs</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Area</td>
                            <td>Table of reference points</td>
                        </tr>
                    </table>
                                        <div class="note-caution"> 
                        <p>
                            <strong>Caution:</strong> For scripts, use <code>'\r\n'</code> to represent new lines, otherwise a multi-line script may not run.
                        </p>
                    </div>
                    <h5>Examples</h5>
                    <p>Create a action changes points on SideA</p>
                    <div class="example">
                        <code>
                            local a = ScenEdit_SetAction({mode=<span class="string">'add'</span>,
                            type=<span class="string">'Points'</span>,
                            name=<span class="string">'sideA loses some ..'</span>, 
                            SideId=<span class="string">'sidea'</span>, 
                            PointChange=<span class="number">-10</span>})
                        </code>
                    </div>

                    <div class="note-alert">
                        <p>
                            <strong>Note:</strong> The variable <code>a</code> will contain the trigger information. It will be <code>nil</code> if the trigger failed in a non-interactive script as in an event.
                        </p>
                    </div>
                    <hr>
                    <h4>Modifying Events</h4>
                    <p>
                        Triggers, conditions and actions (TCA) can be linked to events. A common format is followed for each one.
                    </p>
                    <ul class="ul-no-bullets">
                        <li>(a) <a href="#ScenEdit_SetEventTrigger">ScenEdit_SetEventTrigger( eventName, { table } )</a></li>
                        <li>(b) <a href="#ScenEdit_SetEventCondition">ScenEdit_SetEventCondition( eventName, { table } )</a></li>
                        <li>(c) <a href="#ScenEdit_SetEventAction">ScenEdit_SetEventAction( eventName, { table } )</a></li>
                    </ul>
                    <p>
                        The common keywords used in the Lua table are:
                        <ul class="ul-no-bullets">
                            <li><strong>Description:</strong> The name given to the TCA. The keyword 'name' can also be used for this.</li>
                            <li><strong>Mode:</strong> The type of operation to perform. Operations are 'add', 'remove', and 'replace'.</li>
                            <li><strong>ID:</strong> The GUID used to reference the TCA. This is used internally and is only for reference.</li>
                        </ul>
                        The functions will return the TCA on a success as with the commands above. For the mode='replace', there is an extra keyword 'ReplacedBy' that swaps the old TCA with the new one. The previous one is returned by the function
                    </p>
                    <h5>Examples</h5>
                    <p>Add a new action to an existing event</p>
                    <div class="example">
                        <code>local a = ScenEdit_SetEventAction(<span class="string">'test event'</span>, 
                        {mode=<span class="string">'add'</span>, 
                        name=<span class="string">'test action points'</span>})</code>
                    </div>
                    <div class="note-alert">
                        <p>
                            <strong>Note:</strong> The variable <code>a</code> will contain the trigger information. It will be <code>nil</code> if the trigger failed in a non-interactive script as in an event.
                        </p>
                    </div>

                    <p>Replace an action in an existing event</p>

                    <div class="example">
                        <code>local a = ScenEdit_SetEventAction(<span class="string">'test event'</span>, 
                        {mode=<span class="string">'replace'</span>, 
                        name=<span class="string">'test action message'</span>, 
                        replaceby=<span class="string">'test action points'</span>})</code>
                    </div>
                    <p>
                        Events can also be created and modified through Lua: <code>ScenEdit_SetEvent( eventName, { table } )</code>
                    </p>
                    <p>The common keywords used in the Lua table are:
                        <ul class="ul-no-bullets">
                            <li><strong>Description:</strong> The name given to the Event. The keyword 'name' can also be used for this.</li>
                            <li><strong>Mode:</strong> The type of operation to perform. Operations are 'add' and 'update'.</li>
                            <li><strong>ID:</strong> The GUID used to reference the Event. This is used internally and is only for reference.</li>
                        </ul>
                        The normal Event keywords are accepted in the 'table'.
                    </p>
                        <h5>Examples</h5>
                    
                    <p>Add a new event</p>
                    <p>
                        <div class="example"><code>local a = ScenEdit_SetEvent(<span class="string">'my new event'</span>, {mode=<span class="string">'add'</span>})</code></div>
                        <div class="note-alert">
                        <p>
                            <strong>Note:</strong> The variable <code>a</code> will contain the trigger information. It will be <code>nil</code> if the trigger failed in a non-interactive script as in an event.
                        </p>
                    </div>
                        The <code>ScenEdit_SetEvent(Trigger/Condition/Action)</code> functions then can be run on the new Event to add the required TCAs. In addtion, <code>ScenEdit_GetEvent(EventDescriptionOrID, level)</code> has been updated to return information on the Event.
                    </p>
                    <p>
                        Use level as:
                        <ul class="ul-no-bullets">
                            <li>0 - all details,</li>
                            <li>1 - triggers,</li>
                            <li>2 - conditions,</li>
                            <li>3 - actions,</li>
                            <li>4 - event detail</li>
                        </ul>
                            
                    </p>
                    <p>Special variables:
                        <ul class="ul-no-bullets">
                        <li><code>_enumTable_</code> List of enumerated variable names and values</li>
                        <li><code>_errfnc_</code> Lua Function in which error occurred</li>
                        <li><code>_errmsg_</code> Error message from Lua Function failure</li>
                        </ul>
                    </p>
                    <hr>

                <a class="anchor" id="Globals"></a>
                <h3>Global Keywords</h3>
                <p>
			Command Lua provides several global keywords that can be useful for file handling and/or reading and writing output from your scripts.
                </p>
                <ul>
                    <li>
                        <code>_scriptfolder_</code>: the full path to the folder location of the executing lua script file, or an empty string if the script was not loaded from a lua script file (i.e. run from console, as part of an event action, etc.)
                    </li>
                    <li>
                        <code>_scenariofolder_</code>: the full path to the folder from which the current scenario file was loaded. An empty string is returned if current scenario was not loaded from a scen or save file (i.e. it is a new scenario that has never been saved.)
                    </li>
                    <li>
                        <code>_outputfolder_</code>: the full path to the root folder under which any event exporter (Pro-only) output will be written. It returns an empty string if no output folder is set.
                    </li>
                </ul>
		<hr>
                <a class="anchor" id="ErrorHandling"></a>
                <h3>Error Handling</h3>
                <p>
                    Usually when a Lua script fails, an error is thrown that ends the script at that point. While this
                    may be okay in most cases, it is not often desired.
                </p>
                <p>
                    Whenever a Command Lua function gets an error, it will normally return <code>nil</code>, and the
                    error message will be available as Lua global variables:
                </p>
                <ul>
                    <li>
                        <code>_errmsg_</code>: the last error message
                    </li>
                    <li>
                        <code>_errfnc_</code>: the Command Lua function that gave the error
                    </li>
                    <li>
                        <code>_errnum_</code>: the error code (0 is no error, and any value >0 will be an error)
                    </li>
                </ul>
                <p>
                    Thus if you get back <code>nil</code>, you can check to see if that is due to an error or no data.
                </p>

                <div class="note-alert">
                    <p>
                        <strong>Note:</strong> Due to how errors are now handled from SR7, if a command fails in the
                        console window, it will show an error. If the command runs outside the console (as in an event
                        script), it will not fail with a visible error but return a nil or or some other value.
                    </p>
                </div>

                <h5>Example</h5>
                <p>
                    Without the new error handling, the script below would terminate after the
                    <code>ScenEdit_AddMission()</code> function and the rest of script would not run.
                </p>
                <div class="example">
                    <p>
                        <code>
                            <span class="local">local</span>
                            mission
                            <span class="operator">=</span>
                            ScenEdit_AddMission
                            <span class="operator">(</span>
                            <span class="string">'USA'</span>,
                            <span class="string">'Marker strike'</span>,
                            <span class="string">'strike'</span>,
                            <span class="operator">{</span>
                            type
                            <span class="operator">=</span>
                            <span class="string">'land'</span>
                            <span class="operator">}</span>
                            <span class="operator">)</span>
                            <br>
                            <span class="comparator">if</span> mission
                            <span class="operator">==</span>
                            <span class="nil" />
                            <span class="comparator">then</span>
                            <br>
                            <span class="tab1">
                                <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;if</span>
                                _errnum_
                                <span class="operator">~=</span>
                                <span class="number">0</span>
                                <span class="comparator">then</span>
                                <br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="print" />
                                <span class="operator">(</span>
                                <span class="string">'Failed to add:'</span>
                                .. _errmsg_
                                <span class="operator">)</span>
                                <br>
                                <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;else</span>
                                <br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="print" />
                                <span class="operator">(</span>
                                <span class="string">'Something else'</span>
                                <span class="operator">)</span>
                                <br>
                                <span class="comparator">&nbsp;&nbsp;&nbsp;&nbsp;end</span>
                                <br>
                                <span class="comparator">else</span>
                                <br>
                                &nbsp;&nbsp;&nbsp;&nbsp;<span class="print"></span>
                                <span class="operator">(</span>
                                <span class="string">
                                    mission</span?
                                    <span class="operator">)</span>
                                    <br>
                                    <span class="comparator">end</span>
                                </span>
                        </code>
                    </p>
                </div>
                <div class="note-caution">
                    <p>
                        <strong>Caution:</strong> One issue with commands running in an event is that sometimes they
                        fail with an in-game message that actually stops the rest of the script from running.
                        <strong>Now these event scripts will run without any in-game message showing.</strong> The
                        designer should check the result of the command and handle any error condition, and let the
                        remaining script run as needed.
                    </p>
                </div>

                <p>
                    The design intent is to have all command errors behave in the same fashion in the console window;
                    and the command errors outside a console behave without stopping the script. Which requires the
                    designer to cater for the specific error conditions.
                </p>

                <p>
                    To emulate the expected outcome from an event, put 'Tool_EmulateNoConsole(true)' at the start of the
                    script to be tested; it is not required in the event code as the script is already not running in a
                    console.
                </p>

                <p>
                    Note also, that the Lua history log should also record the event script errors.
                </p>

			</div>
			<div id="footer">
				<p>Copyright &copy; WarfareSims 2020</p>
			</div>
		</div>
	</div>
</body>

</html>
